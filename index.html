<!DOCTYPE html>
<html lang="en">
<head>
  <title>TeamWorkFlo</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link rel="stylesheet" href="./css/style.css">
  <link rel="stylesheet" href="./css/date_slider.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <!--<script src="https://code.highcharts.com/highcharts.js"></script>-->
  <script src="https://code.highcharts.com/stock/highstock.js"></script>
  <script src="https://code.highcharts.com/modules/treemap.js"></script>
  <script src="scripts/activity.js"></script>
  <script src="scripts/person.js"></script>

  <script src="scripts/buckets.min.js"></script>
  <script src="scripts/taskmanager.js"></script>
  <script src="scripts/activitymanager.js"></script>
  <script src="scripts/visualization.js"></script>
  <script src="scripts/filtercontext.js"></script>
  <script src="scripts/rendercontext.js"></script>

<script src="https://code.jquery.com/ui/1.10.3/jquery-ui.min.js"></script>
<script src="scripts/client/dateslider/jQRangeSliderMouseTouch.js"></script>
<script src="scripts/client/dateslider/jQRangeSliderDraggable.js"></script>
<script src="scripts/client/dateslider/jQRangeSliderBar.js"></script>
<script src="scripts/client/dateslider/jQRangeSliderHandle.js"></script>
<script src="scripts/client/dateslider/jQRangeSliderLabel.js"></script>
<script src="scripts/client/dateslider/jQRangeSlider.js"></script>
<script src="scripts/client/dateslider/jQRuler.js"></script>
<script src="scripts/client/dateslider/jQDateRangeSliderHandle.js"></script>
<script src="scripts/client/dateslider/jQDateRangeSlider.js"></script>
  
</head>
  <style type="text/css">
    .top-right-button {
      line-height: 12px;
      width: 35px;
      font-size: 8pt;
      font-family: tahoma;
      margin-top: 1px;
      margin-right: 2px;
      position: absolute;
      top: 0;
      right: 0;
    }
  </style>

</head>
<body style="height:100%">

  <div class="container-full" style="margin-right: 1%; margin-left: 2%;">
    <div class="row content container-full" style="height:100%;" > 

      <div id="vis1" class="vis col-sm-7 fill container-full" style="padding-right: 0px; padding-left: 0px; padding-bottom: 0px; height:100vh;">
        <div class="panel" id="viz_panel_1" style="margin-bottom: 0px;">
          <div class="panel-heading" style="width:200px;">
            <h5 id="primaryViz" class="panel-title">[Main visualization]</h5>
          </div>
          <div class="fill" style="padding:0px;">
            <div id="vis1-body" >
              <!-- <h1>Content goes here</h1> -->
            </div>
            
          </div>
        </div>

        <div class="panel" style="background-color:#668cff; padding-left:15px;" id="viz_control_panel">
          
          <div class="panel-body" style="padding-left:5px;padding-top:0px">


            <div id="control_panel" >

            <table width="100%" height="100%">
            <tr width="100%">
              <td width="30%">
               <h5 class="panel-title"  style="color:white; margin-bottom:15px; margin-top:5px;">Control panel</h5>

               <label style="display:block; color:white; padding-right:10px;">Visualization:<select class="form-control" id="visualization_selector" style="display:block; width:150px; margin-left:10px;">
                <option>All</option>
                <option>Taskload</option>
                <option>Activity</option>
                <option>Gantt</option>
              </select></label>

             
              <button id="show_viz" class="btn btn-primary">Show viz</button></td>
               <td width="70%"> 
            <table width="100%" height="100%">
             <tr width="100%">
              <td>

 <label style="display:inline; color:white; padding-right:10px;">Milestone:<select class="form-control" id="milestones_selector" style="display:inline; width:150px; margin-left:10px;">
                <option>All</option>
                <option>Initial Setup</option>
                <option>Lightweight Prototype</option>
                <option>Functional Prototype</option>
                <option>User Study 2</option>
              </select></label>

              <label style="display:inline; color:white; padding-right:10px;">Actor:<select class="form-control" id="actor_selector" style="display:inline; width:150px; margin-left:10px;">
                <option>All</option>
                <option>Aqib Bhat</option>
                <option>Cullen Brown</option>
                <option>Eric Gonzalez</option>
                <option>Jorge Herrera</option>
              </select></label>
                </td>
                </tr>
                <tr>
                <td>
                  <div id="slider">
                
              </div>
              </td>
                </tr>
               </table>

              </td>
            </tr>
            </table>
           
            </div>

          </div>
        </div>


      </div>

      <div class="vis col-sm-5 left-border" style="padding-bottom: 0px; padding-left: 2px;">

        <div id="vis2" class="vis col-sm-12" style="padding-bottom: 2px; padding-left: 0px; padding-right: 0px;">
          <div class="panel" id="viz_panel_2" style="margin-bottom:0px;">
            <div class="panel-heading" style="width:220px;">
              <h5 id="secondaryViz" class="panel-title">[Secondary visualization]</h5>
            </div>
            <button id="secondary_switch_button" class="top-right-button"><span class="glyphicon glyphicon-resize-full"></span></button>
            <div class="panel-body fill" style="padding:0px;">

              <div id="vis2-body" class="fill">

              </div>
            </div>
          </div>
        </div>


        <div id="vis3" class="vis col-sm-12" style="padding-bottom: 2px; padding-left: 0px; padding-right: 0px; overflow-y:auto;">
          <div class="panel" id="viz_panel_3"  style="margin-bottom:0px;">
            <div class="panel-heading" style="width:220px;">
              <h5 id="tertiaryViz" class="panel-title">[Tertiary visualization]</h5>
            </div>
            <!-- <div stlye="float:right;" ><button class="btn btn-primary" id="prev">Prev</button> <label>Showing 1-15 tasks of 48</label><button class="btn btn-primary" id="next" >Next</button> <button class="btn btn-secondary" style="margin-left:50px;" id="max" >MAX</button></div> -->
            <button id="tertiary_switch_button" class="top-right-button"><span class="glyphicon glyphicon-resize-full"></span></button>
            <div class="panel-body fill" style="padding:0px;"> 
              <div id="vis3-body" class="fill" style="overflow-y:scroll;">
            </div>
          </div>
        </div>


      </div>



    </div>



    
  </div>

 <!--  Copyright 2016 Team Drowning Man <img src="resources/drowning-man.png" alt="Drowning Man Icon" width=24 height=24>. Data is sourced from Slack, Google Drive, and GitHub. -->

<footer>
 <script src="scripts/filtercontext.js"></script>
<script>
  var height = $( window ).height();
//alert(height);


$("#viz_panel_1").css({ 'height': height*.8 + "px" });


$("#viz_control_panel").css({ 'height': height*.23 + "px" });
$("#viz_panel_2").css({ 'height': height/2 + 10 + "px" });
$("#viz_panel_3").css({ 'height': height/2 + 10 + "px" });

$("#vis1-body").css({ 'height': height*.8 -50+ "px" });
//$("#vis2-body").css({ 'height': height/2 - 40 + "px" });
//$("#vis3-body").css({ 'height': height/2 - 40 + "px" });

//localStorage.setItem("main_viz_height",height*.8 - 50);
//localStorage.setItem("secondary_viz_height",height/2 + 10);

$('html, body').css({
  'overflow': 'hidden',
  'height': '100%'
});

$("#slider").dateRangeSlider({
    bounds:{
        min: new Date(1460246400000), //April 10, 2016
        max: new Date(1462838400000) //May 10, 2016
    },
    defaultValues: {
        min: new Date(1460179440000),
        max: new Date(1462857840000)
      }

});


</script>


  <script src="scripts/taskload.js"></script>
  <script src="scripts/activityvis.js"></script>
  <script src="scripts/switchvis.js"></script>
  <script src="scripts/gantt.js"></script>
  <!-- // <script type="text/javascript" src="./scripts/client/gantt_highcharts.js"></script> -->

</footer>


<script>
//taskload vis load information
var taskloadRenderContext = new RenderContext({'renderElement':'#vis1-body', 'labelElement':'#primaryViz', 'condensed':false});
var taskloadFilterContext = new FilterContext({'actor':'','component':'','feature':'',
    'milestone':''});
var taskloadConfiguration = { name:"Taskload", renderer:taskloadRender };

var taskloadVis = new Visualization(taskloadConfiguration);

taskloadVis.render(taskloadRenderContext,taskloadFilterContext);
$(taskloadRenderContext.labelElement).html(taskloadVis.name);
  
//activity visualization load information
var activityRenderContext = new RenderContext({'renderElement':'#vis2-body', 'labelElement':'#secondaryViz', 'condensed':true});
var activityFilterContext = new FilterContext({'actor':'','component':'','feature':'',
    'milestone':''});
var activityConfiguration = { name:"Activity", renderer:activityRender };

var activityVis = new Visualization(activityConfiguration);

activityVis.render(activityRenderContext,activityFilterContext);
$(activityRenderContext.labelElement).html(activityVis.name);
  

//Gantt visualization load configuration
var ganttRenderContext = new RenderContext({'renderElement':'#vis3-body', 'labelElement':'#tertiaryViz','condensed':true});
var ganttFilterContext = new FilterContext({'actor':'All','component':'','feature':'',
    'milestone':'All', 'startTime':'1460246400','endTime':'1462838400'});

var ganttConfiguration = { name:"Gantt", renderer:ganttRender };
var ganttVis = new Visualization(ganttConfiguration);
ganttVis.render(ganttRenderContext,ganttFilterContext);

$(ganttRenderContext.labelElement).html(ganttVis.name);
</script>

<script>
var primaryRenderContext = taskloadRenderContext;
var primaryFilterContext = taskloadFilterContext;
var primaryVis = taskloadVis;

var secondaryRenderContext = activityRenderContext;
var secondaryFilterContext = activityFilterContext;
var secondaryVis = activityVis;

var tertiaryRenderContext = ganttRenderContext;
var tertiaryFilterContext = ganttFilterContext;
var tertiaryVis = ganttVis;
</script>

 <script>

$( "#show_viz" ).click(function() {
  filterVis(primaryVis, primaryRenderContext, primaryFilterContext);
});


$( "#secondary_switch_button" ).click(function() {
  
  var tempVis = primaryVis;

  primaryVis = secondaryVis;

  secondaryVis = tempVis;

  primaryVis.render(primaryRenderContext, primaryFilterContext);
  secondaryVis.render(secondaryRenderContext, secondaryFilterContext);

  $(primaryRenderContext.labelElement).html(primaryVis.name);
  $(secondaryRenderContext.labelElement).html(secondaryVis.name);
});

$( "#tertiary_switch_button" ).click(function() {
  
  var tempElem1 = primaryRenderContext.renderElement;
  var tempElem2 = primaryRenderContext.labelElement;
  var tempVis = primaryVis;
  var tempRender = primaryRenderContext;
  var tempFilter = primaryFilterContext;

  primaryRenderContext.renderElement = tertiaryRenderContext.renderElement;
  primaryRenderContext.labelElement = tertiaryRenderContext.labelElement;
  tertiaryRenderContext.renderElement = tempElem1;
  tertiaryRenderContext.labelElement = tempElem2;

  primaryVis = tertiaryVis;
  primaryRenderContext = tertiaryRenderContext;
  primaryFilterContext = tertiaryFilterContext;

  tertiaryVis = tempVis;
  tertiaryRenderContext = tempRender;
  tertiaryFilterContext = tempFilter;

  primaryVis.render(primaryRenderContext, primaryFilterContext);
  tertiaryVis.render(tertiaryRenderContext, tertiaryFilterContext);

  $(primaryRenderContext.labelElement).html(primaryVis.name);
  $(tertiaryRenderContext.labelElement).html(tertiaryVis.name);


});

// //alert();

//       //    var milestones_selector = $("#milestones_selector");
// $.get("./twfapi/index.php?method=tasks", function(data, status){
//     var json_data = JSON.parse(data);
//     //console.log("Fund data! \n%s\n", data);
//     localStorage.setItem("task_array",JSON.stringify(json_data['data']));
//     if(json_data['status']==200){
         
//           var milestones = getMilestones(json_data['data']);
//           for(i = 0; i < milestones.length; i++) {
//            $('#milestones_selector').append('<option value='+milestones[i]+'>'+milestones[i]+'</option>');
//          }
//         }else{
//           alert("Error "+ json_data['status']);
//         }
//       });



  
 </script>




</body>

</html>
