<!DOCTYPE html>
<html lang="en">
<head>
  <title>TeamWorkFlo</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link rel="stylesheet" href="./css/style.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="d3/d3.min.js"></script>
  <script src="scripts/activity.js"></script>
  <script src="scripts/person.js"></script>
  <script src="scripts/client/taskmanager.js"></script>
  <script src="scripts/client/activitymanager.js"></script>
  <script src="scripts/client/visualization.js"></script>
  <script src="http://code.highcharts.com/stock/highstock.js"></script>
  
</head>
<body>
  <nav class="navbar navbar-default">
    <div class="navbar-header">
      <a class="navbar-brand" href="#">TeamWorkFlo</a>
      <button id="call_api_activities">Call Activities</button>
      <button id="call_api_tasks">Call Tasks</button>
    </div>
  </nav>
  <div class="container">
    <div>
      <div id="vis1" class="vis col-sm-12">
        <div class="panel panel-card">
          <div class="panel-heading" >
            <h5 class="panel-title"  >[Main visualization]</h5>
          </div>
          <div class="panel-body" style="height: 870px;">
            <select class="selectpicker" class="select" id="milestones_selector" style="display:block;">
              <input id="work_day" class="date" type="date" name="wday"  style="display:block;">
              <button id="show_viz" class="btn">Show viz</button>

            </select>
            <div class="col-sm-12" >
             <div class="col-sm-2" >
             </div>
             <div class="col-sm-10" id="viz_one" >
             </div>
           </div>
         </div>
       </div>
     </div>
   </div>
 
</div>
<footer>

  Copyright 2016 Team Drowning Man <img src="resources/drowning-man.png" alt="Drowning Man Icon" width=24 height=24>. Data is sourced from Slack, Google Drive, and GitHub.
</footer>
<!--<script src="scripts/client/taskload.js"></script>-->s
<script type="text/javascript" src="./scripts/client/gantt_highcharts.js"></script>

<script>



          //var milestones_selector = $("#milestones_selector");
$.get("./twfapi/index.php?method=tasks", function(data, status){
    var json_data = JSON.parse(data);
    //console.log("Fund data! \n%s\n", data);
    localStorage.setItem("task_array",JSON.stringify(json_data['data']));
    if(json_data['status']==200){
         
          var milestones = getMilestones(json_data['data']);
          for(i = 0; i < milestones.length; i++) {
           $('#milestones_selector').append('<option value='+milestones[i]+'>'+milestones[i]+'</option>');
         }
        }else{
          alert("Error "+ json_data['status']);
        }
      });



  

  $( "#show_viz" ).click(function() {
    var date = $( "#work_day" ).val();
    var milestone = $( "#milestones_selector option:selected" ).text();

    showVisualization(date,milestone);




  });



//JQuery Methods for API Call Example
$( "#call_api_activities" ).click(function() {
  $.get("./twfapi/index.php?method=activities", function(data, status){
    var json_data = JSON.parse(data);
    console.log("Found data! \n%s\n", data);
    if(json_data['status']==200){
          //json_data['data'] contains the array we need
        }else{
          alert("Error "+ json_data['status']);
        }

        
      });
});


function showVisualization(date,milestone){

    var json_data = JSON.parse(localStorage.getItem("task_array"));
    //console.log("Found data! \n%s\n", data);

          var milestones = getMilestones(json_data);
          var milestone_tasks = getGanttTasks(json_data,milestone);
          var formatted_date = date.replace("-", "/");
          var formatted_date = formatted_date.replace("-", "/");
          showChart(formatted_date, milestones,milestone_tasks);


}


$( "#call_api_tasks" ).click(function() {
  $.get("./twfapi/index.php?method=tasks", function(data, status){
    var json_data = JSON.parse(data);
    console.log("Fund data! \n%s\n", data);

    if(json_data['status']==200){
          //First parameter is going to be the data
          //The second parameter is going to be the milestone
          //The third parameter is going to be a date. It will show the day before and the day after that.
          var milestones = getMilestones(json_data['data']);
          //var milestones_selector = $("#milestones_selector");

          for(i = 0; i < milestones.length; i++) {
           $('#milestones_selector').append('<option value='+i+'>'+milestones[i]+'</option>');
         }







          //getDataFromMilestone

          //showChart(json_data['data']);
        }else{
          alert("Error "+ json_data['status']);
        }


      });
});
</script>




</body>
</html>
